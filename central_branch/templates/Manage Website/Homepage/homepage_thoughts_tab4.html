{% block homepage_thoughts_tab %} {% load static %}
<style>
  .thought_outer_container {
    border-radius: 11px;
    background: #00629b0e;
    width: 372px;
    padding: 12px;
    margin-top: 12px;
    break-inside: avoid; /* Prevents item from splitting between columns */
  }
  .thought_outer_container p {
    background: #00629b3f;
    padding: 7px;
    border-radius: 5px;
    margin: 0;
  }
  .thought_container {
    column-count: 3;
    column-gap: 12px;
    width: 100%;
  }
  .add_thought_btn {
    border-radius: 4px;
    border: 1px solid transparent;
    color: #002855d8;
    background-color: #00629b32;
    padding: 3px 16px;
    transition: all 0.3s ease-in-out;
    cursor: pointer;
    text-align: right;
  }

  .add_thought_btn:hover {
    background-color: #002855d8;
    color: white;
  }
  .delete_thought_btn {
    color: black;
    background: #ff5959;
    padding: 5px;
    border-radius: 6px;
    border: 1px solid #000;
    position: relative;
    bottom: 4px;
    cursor: pointer;
    transition: all 0.3s ease-in-out;
  }
  .delete_thought_btn:hover {
    background: #f64040;
  }
  .modal_thought {
    display: block;
    opacity: 0;
    position: fixed;
    z-index: -1;
    padding-top: 5vh;
    left: 0;
    top: 0;
    width: 100%;
    height: 120%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.4);
    align-items: center;
    transition: all 0.3s ease-in-out;
    transform: translateY(-20px);
  }

  .modal_thought_content {
    background-color: white;
    width: 40%;
    max-height: 90vh;
    overflow-y: auto;
    border-radius: 7px;
    box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
    margin: auto;
    padding: 10px 20px;
  }
  .modal_delete_thought {
    display: block;
    opacity: 0;
    position: fixed;
    z-index: -1;
    padding-top: 5vh;
    left: 0;
    top: 0;
    width: 100%;
    height: 120%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.4);
    align-items: center;
    transition: all 0.3s ease-in-out;
    transform: translateY(-20px);
  }

  .modal_delete_thought_content {
    background-color: white;
    width: 40%;
    max-height: 90vh;
    overflow-y: auto;
    border-radius: 7px;
    box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
    margin: auto;
    padding: 10px 20px;
  }
  .modal_thought_content h1,
  .modal_delete_thought_content h1 {
    font-size: 18px;
    margin: 0px;
  }
  @media (max-width: 900px) {
    .img_inner_container {
      flex: 0 0 calc((100% - 12px) / 2);
      max-width: calc((100% - 12px) / 2);
    }
  }
  @media (max-width: 600px) {
    .img_inner_container {
      flex: 0 0 100%;
      max-width: 100%;
    }
  }
  @media (max-width: 800px) {
    .modal_thought_content,
    .modal_delete_thought_content {
      width: 90%;
    }
  }
  @media (max-width: 500px) {
    .modal_thought_content,
    .modal_delete_thought_content {
      width: 95%;
    }
    .video-wrapper,
    .img-wrapper {
      height: 150px;
    }
  }
  /* Medium screens: 2 columns */
  @media (max-width: 1400px) {
    .thought_container {
      column-count: 2;
    }
    .thought_outer_container {
      width: 100%;
    }
  }

  /* Small screens: 1 column */
  @media (max-width: 480px) {
    .thought_container {
      column-count: 1;
    }
    .thought_outer_container {
      width: 100%;
    }
  }
</style>

<div id="tab4" class="tab-content" style="border: none;">
  <!-- <h2 style="text-align:center;">HomePage Thoughts</h2> -->
  <!-- <br> -->
  <div ui-view class="app-body" id="view">
    <div class="container" style="margin: auto;">
      <div class="add_btn_container">
        <button
          type="button"
          class="open_modal_btn add_thought_btn"
          data-target="#add_thought_modal"
        >
          Add thought
        </button>
      </div>

      <div class="thought_container">
        {% for thought in all_thoughts %}
        <div class="thought_outer_container" data-thought-id="{{ thought.id }}">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
            "
          >
            <h6 style="font-weight: bold">{{ thought.author }}</h6>
            <i
              class="fas fa-trash delete_thought_btn open_modal_btn"
              data-target="#delete_thought_modal"
              onclick="deletethoughts({{thought.id}})"
              title="Delete"
            ></i>
          </div>
          <p>{{ thought.quote }}</p>
        </div>
        {% endfor %}
      </div>

      {% comment %}
      <div class="thought_container">
        <div class="thought_outer_container" data-thought-id="{{ thought.id }}">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
            "
          >
            <h6 style="font-weight: bold">John Doe</h6>
            <i
              class="fas fa-trash delete_thought_btn open_modal_btn"
              data-target="#delete_thought_modal"
              title="Delete"
            ></i>
          </div>
          <p>A good Branch</p>
        </div>
        <div class="thought_outer_container" data-thought-id="{{ thought.id }}">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
            "
          >
            <h6>John Doe</h6>
            <i
              class="fas fa-trash delete_thought_btn open_modal_btn"
              data-target="#delete_thought_modal"
              title="Delete"
            ></i>
          </div>
          <p>
            A good Branch Lorem ipsum dolor sit, amet consectetur adipisicing
            elit. Vitae architecto magni in quos molestias animi. Quam illo
            illum non fuga temporibus officia tenetur voluptatum modi.
          </p>
        </div>
        <div class="thought_outer_container" data-thought-id="{{ thought.id }}">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
            "
          >
            <h6>John Doe</h6>
            <i
              class="fas fa-trash delete_thought_btn open_modal_btn"
              data-target="#delete_thought_modal"
              title="Delete"
            ></i>
          </div>
          <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laborum
            maxime ab minus obcaecati nam ducimus.
          </p>
        </div>
        <div class="thought_outer_container" data-thought-id="{{ thought.id }}">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
            "
          >
            <h6>John Doe</h6>
            <i
              class="fas fa-trash delete_thought_btn open_modal_btn"
              data-target="#delete_thought_modal"
              title="Delete"
            ></i>
          </div>
          <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit.</p>
        </div>
      </div>
    </div>
    {% endcomment %}

    <!-- <div class="box-body">
                
                        <div class="form-group row">
                            <label for="captions" class="col-sm-3 form-control-label">Add Thoughts:</label>
                            <div class="col-sm-7">
                            </div>
                            <div class="col-sm-2 d-flex align-items-center justify-content-center">
                                <button type="button" class="circle-btn plus-sign" data-toggle="modal" data-target="#AddThoughtsModal"></button>
                            </div>
                        </div>
                        
                        <hr>
                    <div id="captions-container" class="mt-3">
                            <label class="mb-0">Added Thoughts:</label> 
                            {% for thought in all_thoughts%}
                            <div class="row container-fluid bg-light mt-3" style="margin:auto;">
                                <div class="col-sm-11">
                                    <a href="#" class="btn btn-link btn-block" data-toggle="modal" data-target="#EditCaptionModal{{thought.pk}}">{{thought.author}}</a>
                                </div>
                                <div class="col-sm-1 d-flex align-items-center justify-content-center">
                                    <button type="button" class="close" aria-label="Close" data-toggle="modal" data-target="#ConfirmDeleteModalForThoughts"  onclick="openModal('{{thought.pk}}')">âœ–</button>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
        
                        <br>
                        <div class="footer" style="position:right;">
                        </div>
                    </div> -->

    <!-- <div class="modal fade" id="AddThoughtsModal" tabindex="-1" role="dialog" aria-labelledby="AddCategoryModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="AddCategoryModalLabel">Add Thoughts:</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form id="myForm" method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="box-body">
                                    <br>
                                        <br>
            
                                        <div class="form-group">
                                            <label>Author<span style="color:red">*<span></label>
                                            <input
                                            type="text" 
                                            class="form-control"
                                            name="author" 
                                            placeholder="Enter your name" 
                                            maxlength="100"
                                            required
                                            >
                                        </div>
                                        <br>
                        
                                        <div class="form-group">
                                            <label>Your Thoughts (you can put them in " ")<span style="color:red">*<span></label> 
                                            <input 
                                            class="form-control" 
                                            name="your_thoughts"
                                            placeholder="Express your inner thoughts" 
                                            required
                                            >
                                        </div>
                                        <br>
                                        <div class="form-group text-center">
                                            <input type="submit" name="save" class="btn btn-outline-success p-x-md" value="Save">
                                        </div>
                                        <br>
                                </div>
                            </form>
                    </div>
                </div>
            </div> -->
    <!-- {% for thought in all_thoughts %}
            <div class="modal fade" id="EditCaptionModal{{thought.pk}}" tabindex="-1" role="dialog" aria-labelledby="EditCaptionModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editCaptionModalLabel{{thought.pk}}">Edit Thoughts</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form id="myForm" method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="box-body">
                                    <br>
                                        <br>
            
                                        <div class="form-group">
                                            <label>Author<span style="color:red">*<span></label>
                                            <input
                                            type="text" 
                                            class="form-control"
                                            name="author_edit" 
                                            placeholder="Enter your name" 
                                            maxlength="100"
                                            required
                                            value="{{thought.author}}"
                                            >
                                        </div>
                                        <br>
                        
                                        <div class="form-group">
                                            <label>Your Thoughts (you can put them in " ")<span style="color:red">*<span></label> 
                                            <input 
                                            class="form-control" 
                                            name="your_thoughts_edit"
                                            placeholder="Express your inner thoughts" 
                                            required
                                            value="{{thought.quote}}"
                                            >
                                        </div>
                                        <br>
                                        <div class="form-group text-center">
                                            <input type = "hidden" value="{{thought.pk}}" name="thought_id">
                                            <input type="submit" name="update" class="btn btn-outline-success p-x-md" value="Update">
                                        </div>
                                        <br>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %} -->

    <!-- <div class="modal fade" id="ConfirmDeleteModalForThoughts" tabindex="-1" role="dialog" aria-labelledby="ConfirmDeleteModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-top" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="confirmDeleteModalLabel">Confirm Delete</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <form method="POST">
                    <div class="modal-body">
                        
                            {% csrf_token %}
                            <p><input id="delete_thought" name="delete_thought" type="hidden"></p>
                            Are you sure you want to delete this ?
                     
                    </div>
                    <div class="modal-footer">
                        <input type="submit" class="btn btn-outline-danger" value="Confirm" name="thought_delete">
                        <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
                    </div>
                </form>
                </div>
            </div>
        </div> -->

    <div id="add_thought_modal" class="modal_thought">
      <form method="post" id="form">
        {% csrf_token %}
        <input id="delete_thought" name="delete_thought" type="hidden">

        <div class="modal_thought_content">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 10px;
            "
          >
            <h1>Add Thought</h1>
            <button type="button" class="x_btn">
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>

          <div class="container" style="margin-top: 40px">
            <div class="text_fld" style="grid-template-columns:1fr">
              <h2 style="font-size: 15px; margin: 0px">
                Author Name & Position
              </h2>
              <input type="text" class="text_fld_ip" name="author" required />
            </div>

            <div>
              <h2 style="font-size: 15px">Your Thoughts:</h2>
              <textarea
                style="
                  width: 100%;
                  border: 1px solid #ccc;
                  min-height: 100px;
                  padding: 6px;
                "
                name="your_thoughts"
                class="desc_fld"
                required
              ></textarea>
            </div>

            <div style="display: flex; justify-content: end">
              <div style="display: flex">
                <button type="button" class="close_btn">Cancel</button>
                <input
                  type="submit"
                  name="save"
                  class="confirm_btn"
                  style="margin-left: 10px"
                  value="Save"
                >
                  
                
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>

    <div id="delete_thought_modal"  class="modal_delete_thought">
      <form method="post" id="form">
        {% csrf_token %}
        <input type="hidden" name="delete_thought" id="delete_thought_id">
        <div class="modal_delete_thought_content">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 10px;
            "
          >
            <h1>Delete Thought</h1>
            <button type="button" class="x_btn">
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>

          <h2 style="font-size: 20px; margin-top: 20px">
           
            Are you sure you want to delete this thought?
          </h2>

          <div style="display: flex; justify-content: end; padding-top: 20px">
            <div style="display: flex">
              <button type="button" class="close_btn">Cancel</button>
              <input
                type="submit"
                name="thought_delete"
                class="delete_btn"
                style="margin-left: 10px"
                value="Yes, delete"
              >
                
              
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<script>
  // ====== ADD THOUGHT MODAL ======
  const addThoughtBtns = document.querySelectorAll(".add_thought_btn"); // Add your trigger class
  addThoughtBtns.forEach((btn) => {
    btn.addEventListener("click", () => {
      const modalId = btn.getAttribute("data-target");
      const modal = document.querySelector(modalId);
      if (modal) {
        modal.style.transform = "translateY(0px)";
        modal.style.zIndex = "103100";
        modal.style.opacity = "1";
        document.body.classList.add("modal-open");
      }
    });
  });

  const addThoughtCloseBtns = document.querySelectorAll(
    "#add_thought_modal .x_btn, #add_thought_modal .close_btn"
  );
  addThoughtCloseBtns.forEach((btn) => {
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      const modal = btn.closest(".modal_thought");
      if (modal) {
        modal.style.transform = "translateY(-50px)";
        modal.style.zIndex = "-100";
        modal.style.opacity = "0";
        document.body.classList.remove("modal-open");
      }
    });
  });

  const addThoughtModal = document.querySelector("#add_thought_modal");
  if (addThoughtModal) {
    addThoughtModal.addEventListener("click", (event) => {
      const modalContent = addThoughtModal.querySelector(
        ".modal_thought_content"
      );
      if (!modalContent.contains(event.target)) {
        addThoughtModal.style.transform = "translateY(-50px)";
        addThoughtModal.style.zIndex = "-100";
        addThoughtModal.style.opacity = "0";
        document.body.classList.remove("modal-open");
      }
    });
  }

  // ====== DELETE THOUGHT MODAL ======
  const deleteThoughtBtns = document.querySelectorAll(".delete_thought_btn"); // Add your trigger class
  deleteThoughtBtns.forEach((btn) => {
    btn.addEventListener("click", () => {
      const modalId = btn.getAttribute("data-target");
      const modal = document.querySelector(modalId);
      if (modal) {
        modal.style.transform = "translateY(0px)";
        modal.style.zIndex = "103100";
        modal.style.opacity = "1";
        document.body.classList.add("modal-open");
      }
    });
  });

  const deleteThoughtCloseBtns = document.querySelectorAll(
    "#delete_thought_modal .x_btn, #delete_thought_modal .close_btn"
  );
  deleteThoughtCloseBtns.forEach((btn) => {
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      const modal = btn.closest(".modal_delete_thought");
      if (modal) {
        modal.style.transform = "translateY(-50px)";
        modal.style.zIndex = "-100";
        modal.style.opacity = "0";
        document.body.classList.remove("modal-open");
      }
    });
  });

  const deleteThoughtModal = document.querySelector("#delete_thought_modal");
  if (deleteThoughtModal) {
    deleteThoughtModal.addEventListener("click", (event) => {
      const modalContent = deleteThoughtModal.querySelector(
        ".modal_delete_thought_content"
      );
      if (!modalContent.contains(event.target)) {
        deleteThoughtModal.style.transform = "translateY(-50px)";
        deleteThoughtModal.style.zIndex = "-100";
        deleteThoughtModal.style.opacity = "0";
        document.body.classList.remove("modal-open");
      }
    });
  }


  function deletethoughts(thoughtId) {
  // For the modal's hidden input
  var input = document.getElementById('delete_thought_id');
  if (input) {
    input.value = thoughtId;
  }
}

</script>

{% endblock homepage_thoughts_tab %}
